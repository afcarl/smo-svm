(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     34656,        906]
NotebookOptionsPosition[     33740,        871]
NotebookOutlinePosition[     34094,        887]
CellTagsIndexPosition[     34051,        884]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Simplified SMO Algorithm", "Subsubtitle",
 CellChangeTimes->{{3.513336691097033*^9, 3.513336694190647*^9}, 
   3.513374586893697*^9, {3.5135160344112177`*^9, 3.5135160361943913`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "50"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "sample", " ", "points"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", "2"}], ";"}], 
  RowBox[{"(*", "Dimension", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Training", " ", "data"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["n", "2"], ",", "d"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["n", "2"], ",", "d"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"l1", ",", "l2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         FractionBox["n", "2"]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         FractionBox["n", "2"]}], "}"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.513518805803048*^9, 3.513518826814232*^9}}],

Cell[CellGroupData[{

Cell[BoxData["x"], "Input",
 CellChangeTimes->{3.5139344219540567`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5914343359564113`", ",", "2.8170774391667193`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0652732216648775`", ",", "2.0439911912969353`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2712970686391347`", ",", "0.8406696997935642`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.3887243263285693`", ",", "2.3081573484338893`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25351424257287003`", ",", 
     RowBox[{"-", "0.8435889964891989`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.4099049011750535`"}], ",", 
     RowBox[{"-", "0.9189528028617804`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2869757262987189`"}], ",", "3.3577435973090837`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.26411402724663235`", ",", "2.417320768920942`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.030112599727102785`"}], ",", "0.8985459538159208`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.538055332095946`", ",", "0.053112901935738144`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0.3559181139250589`", ",", 
     RowBox[{"-", "0.8435836942304404`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9834781673831624`", ",", "1.1840463212227625`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8307397438723584`", ",", 
     RowBox[{"-", "0.3146716192815777`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1174059423395541`", ",", "1.912511479922979`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.109966982636658`", ",", "1.1085154620964452`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0966750209840064`", ",", "1.529311971052099`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8997189067901762`", ",", "1.9662203085532517`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.27230418407432944`"}], ",", "1.3334581305975661`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.03338157511041262`", ",", "0.5867121894987157`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"1.562158295650887`", ",", "0.48155431194402787`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.3940170994994796`"}], ",", "2.0270483460061635`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.562893883046225`", ",", "1.0281137706406493`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5498206595507502`"}], ",", "1.5851486563921817`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.134989682200405`", ",", "1.3647220414022105`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5368243919898052`", ",", "0.8809663985622103`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.10433291607951811`"}], ",", "0.026675074008809085`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.9857770232271057`"}], ",", 
     RowBox[{"-", "1.7155230760584823`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.2442983113280623`"}], ",", 
     RowBox[{"-", "0.23201530098881884`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.15363075936768422`", ",", 
     RowBox[{"-", "1.115488040273951`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.7433894178439249`"}], ",", 
     RowBox[{"-", "0.786129032614499`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2880059633084754`"}], ",", 
     RowBox[{"-", "1.206588677863951`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.6637641714054712`"}], ",", 
     RowBox[{"-", "1.3306133871877823`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7848558848072789`"}], ",", 
     RowBox[{"-", "1.9897598891521904`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9679955449330531`", ",", 
     RowBox[{"-", "0.4694913542401342`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6025018090625347`", ",", 
     RowBox[{"-", "0.32018294199255937`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.2262632637787507`"}], ",", 
     RowBox[{"-", "2.26505143353627`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.244644603088327`"}], ",", 
     RowBox[{"-", "1.0317813240948193`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.5801556270143151`"}], ",", 
     RowBox[{"-", "1.9489679865007659`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.6183011739190425`"}], ",", 
     RowBox[{"-", "0.15670148010780693`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9446112595975289`"}], ",", 
     RowBox[{"-", "2.748035794006896`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8075119128747787`"}], ",", 
     RowBox[{"-", "2.3143134314694764`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0153408621325113`", ",", "0.01001455297104692`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.49384918383889687`"}], ",", 
     RowBox[{"-", "2.1401170067415447`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.02405013661575861`", ",", 
     RowBox[{"-", "0.7132816684144399`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.6622062908000024`"}], ",", 
     RowBox[{"-", "1.1957276464259192`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.37958589856872804`"}], ",", 
     RowBox[{"-", "1.7511348591182772`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.1815591606599396`"}], ",", 
     RowBox[{"-", "0.3004613459064194`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.2465470133229044`"}], ",", 
     RowBox[{"-", "0.77092084560922`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.1552951841561756`"}], ",", 
     RowBox[{"-", "1.5114848811812343`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.9009640920520665`"}], ",", "0.3693527058155923`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.513934422150815*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["y"], "Input",
 CellChangeTimes->{3.513934423771896*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.513934423879459*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Body", " ", "of", " ", "SMO", " ", "Algorithm", " ", "Iterate"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"X_", ",", "\[Alpha]_", ",", "b_", ",", 
      RowBox[{"Ker_:", "DefaultKernel"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Alpha]", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"y", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"Ker", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "X"}], "]"}]}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "+", "b"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"x_", ",", "y_", ",", "\[Alpha]_", ",", "i_", ",", "b_"}], "]"}],
     ":=", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]", ",", "b"}], "]"}], 
     "-", 
     RowBox[{"y", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"x_", ",", "y_", ",", "i_", ",", "j_", ",", 
      RowBox[{"Ker_:", "DefaultKernel"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"Ker", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ")"}]}], "-", 
     RowBox[{"Ker", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", 
     RowBox[{"Ker", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", 
      RowBox[{"x_", ",", "y_", ",", "i_", ",", "j_", ",", "\[Alpha]_", ",", 
       RowBox[{"c_:", "c"}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "==", 
        RowBox[{"y", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "+", 
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "c"}]}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "+", 
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "c"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"x_", ",", "y_", ",", "i_", ",", "j_", ",", "\[Alpha]_", ",", 
       RowBox[{"c_:", "c"}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "==", 
        RowBox[{"y", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"c", ",", 
         RowBox[{
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"c", ",", 
         RowBox[{"c", "+", 
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ActOnParameteri", "[", 
     RowBox[{"x_", ",", "y_", ",", "\[Alpha]_", ",", "i_", ",", "b_", ",", 
      RowBox[{"c_:", "c"}], ",", 
      RowBox[{"tol_:", "tol"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", "i", "]"}], "]"}], 
         RowBox[{"e", "[", 
          RowBox[{"x", ",", "y", ",", "\[Alpha]", ",", "i", ",", "b"}], 
          "]"}]}], "<", 
        RowBox[{"-", "tol"}]}], "&&", 
       RowBox[{
        RowBox[{"\[Alpha]", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "<", "c"}]}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", "i", "]"}], "]"}], 
         RowBox[{"e", "[", 
          RowBox[{"x", ",", "y", ",", "\[Alpha]", ",", "i", ",", "b"}], 
          "]"}]}], ">", "tol"}], "&&", 
       RowBox[{
        RowBox[{"\[Alpha]", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ">", "0"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iStep", "[", 
     RowBox[{"x_", ",", "y_", ",", "\[Alpha]_", ",", "i_", ",", "b_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "x", "]"}]}], ",", 
        RowBox[{"c", "=", "c"}], ",", 
        RowBox[{"\[Alpha]n", "=", "\[Alpha]"}], ",", "\[Alpha]iold", ",", 
        "\[Alpha]jold", ",", "l", ",", "h", ",", "eta", ",", 
        RowBox[{"tol", "=", "tol"}], ",", "b1", ",", "b2", ",", 
        RowBox[{"Ker", "=", "DefaultKernel"}], ",", 
        RowBox[{"bb", "=", "b"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"j", "=", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "\[Equal]", "i"}], ",", 
         RowBox[{"j", "=", "n"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Alpha]iold", ",", "\[Alpha]jold"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Alpha]n", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Alpha]n", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"L", "[", 
         RowBox[{"x", ",", "y", ",", "i", ",", "j", ",", "\[Alpha]n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"H", "[", 
         RowBox[{"x", ",", "y", ",", "i", ",", "j", ",", "\[Alpha]n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"\[Eta]", "[", 
         RowBox[{"x", ",", "y", ",", "i", ",", "j"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"l", "\[Equal]", "h"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]n", ",", "bb"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"eta", "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]n", ",", "bb"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]n", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"\[Alpha]n", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "-", 
         RowBox[{
          FractionBox["1", "eta"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"e", "[", 
               RowBox[{"x", ",", "y", ",", "\[Alpha]n", ",", "i", ",", "b"}], 
               "]"}], "-", 
              RowBox[{"e", "[", 
               RowBox[{"x", ",", "y", ",", "\[Alpha]n", ",", "j", ",", "b"}], 
               "]"}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]n", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{
               RowBox[{"\[Alpha]n", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ">", "h"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{
               RowBox[{"\[Alpha]n", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "<", "l"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"\[Alpha]n", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"\[Alpha]n", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "-", "\[Alpha]jold"}], "]"}], 
          "<", "tol"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]n", ",", "bb"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]n", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"\[Alpha]n", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"y", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Alpha]jold", "-", 
            RowBox[{"\[Alpha]n", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b1", "=", 
        RowBox[{"bb", "-", 
         RowBox[{"e", "[", 
          RowBox[{"x", ",", "y", ",", "\[Alpha]n", ",", "i", ",", "bb"}], 
          "]"}], "-", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]n", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "\[Alpha]iold"}], ")"}], 
          RowBox[{"Ker", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]n", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "-", "\[Alpha]jold"}], ")"}], 
          RowBox[{"Ker", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b2", "=", 
        RowBox[{"bb", "-", 
         RowBox[{"e", "[", 
          RowBox[{"x", ",", "y", ",", "\[Alpha]n", ",", "j", ",", "bb"}], 
          "]"}], "-", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]n", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "\[Alpha]iold"}], ")"}], 
          RowBox[{"Ker", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]n", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "-", "\[Alpha]jold"}], ")"}], 
          RowBox[{"Ker", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bb", "=", 
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b1", ",", 
              RowBox[{"0", "<", 
               RowBox[{"\[Alpha]n", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "<", "c"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b2", ",", 
              RowBox[{"0", "<", 
               RowBox[{"\[Alpha]n", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "<", "c"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2"}], ")"}], "/", "2"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"numChangedAlphas", "++"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]n", ",", "bb"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.513357222425167*^9, 3.5133572455306*^9}, {
   3.5133573325729933`*^9, 3.513357363744349*^9}, {3.513357398535492*^9, 
   3.513357402014941*^9}, 3.513357530267668*^9, {3.513358519821607*^9, 
   3.513358534342781*^9}, {3.51336035466986*^9, 3.51336042195179*^9}, {
   3.513360529927579*^9, 3.513360572602495*^9}, {3.5133609522550783`*^9, 
   3.513360958643504*^9}, {3.513361013697938*^9, 3.513361015222312*^9}, {
   3.513361102396096*^9, 3.513361213533305*^9}, {3.513361246546465*^9, 
   3.5133612468340263`*^9}, {3.51336147807395*^9, 3.513361487707102*^9}, {
   3.5133622948752127`*^9, 3.513362319902231*^9}, {3.513365045426545*^9, 
   3.513365050963317*^9}, {3.513365117842079*^9, 3.513365118293676*^9}, {
   3.513365149583185*^9, 3.513365155272252*^9}, {3.513365246578233*^9, 
   3.513365256160874*^9}, {3.513365548450886*^9, 3.513365553102974*^9}, {
   3.513367248053008*^9, 3.513367262906808*^9}, {3.513367460476679*^9, 
   3.513367474070313*^9}, {3.513367835245205*^9, 3.513367845349024*^9}, {
   3.513367926540976*^9, 3.513367954952478*^9}, {3.513368026635173*^9, 
   3.5133680470510883`*^9}, {3.513368349320052*^9, 3.513368350622703*^9}, {
   3.513368559155903*^9, 3.513368594871256*^9}, {3.513368657264338*^9, 
   3.513368728677084*^9}, {3.513368775241297*^9, 3.51336880402065*^9}, {
   3.513368843691873*^9, 3.513368920968748*^9}, {3.5133689907435007`*^9, 
   3.513369004964931*^9}, {3.513369038364211*^9, 3.513369066421522*^9}, {
   3.513369112428876*^9, 3.513369113365587*^9}, {3.513369492522966*^9, 
   3.513369518185658*^9}, {3.513369553679537*^9, 3.513369555372116*^9}, {
   3.513369638787306*^9, 3.513369722270094*^9}, {3.51336976287545*^9, 
   3.5133697908006697`*^9}, {3.513369824981463*^9, 3.513369838262504*^9}, {
   3.513369920386105*^9, 3.5133699647023563`*^9}, {3.513370006916457*^9, 
   3.513370056030364*^9}, {3.513370108320141*^9, 3.513370108832906*^9}, {
   3.513370155488785*^9, 3.5133703055619926`*^9}, {3.5133703403043203`*^9, 
   3.5133704035249453`*^9}, {3.5133711496535788`*^9, 3.513371167530467*^9}, {
   3.513371221733129*^9, 3.513371291364916*^9}, 3.513373247273692*^9, {
   3.5133733213404417`*^9, 3.513373395521085*^9}, {3.513373657370216*^9, 
   3.51337370904935*^9}, {3.5133739300594378`*^9, 3.513373954219401*^9}, {
   3.513374221818027*^9, 3.513374222180523*^9}, {3.513374545146987*^9, 
   3.5133746182436457`*^9}, {3.513374669505481*^9, 3.513374671900959*^9}, {
   3.5133747077702923`*^9, 3.513374736438582*^9}, {3.513374772910562*^9, 
   3.513374810599864*^9}, {3.513374857183135*^9, 3.513374879823091*^9}, {
   3.513374915134046*^9, 3.513374950000766*^9}, {3.513375141790017*^9, 
   3.513375155124802*^9}, {3.5133752428746243`*^9, 3.513375257500762*^9}, 
   3.51337537451254*^9, {3.513375671457746*^9, 3.513375761068074*^9}, {
   3.513375822970521*^9, 3.513375827835391*^9}, {3.513375875677312*^9, 
   3.513375925280788*^9}, {3.5133759603877563`*^9, 3.5133759688254128`*^9}, {
   3.513376029667138*^9, 3.5133760944193563`*^9}, {3.513376161797978*^9, 
   3.5133762008038893`*^9}, {3.513376287387931*^9, 3.5133763570699453`*^9}, {
   3.5133764491780357`*^9, 3.51337645301794*^9}, {3.513376599294725*^9, 
   3.513376599396975*^9}, {3.51337664697512*^9, 3.5133766495598*^9}, {
   3.513376925686638*^9, 3.513376930684257*^9}, {3.5135114750559797`*^9, 
   3.513511490551193*^9}, {3.513511591749916*^9, 3.5135116202698593`*^9}, {
   3.513511968047179*^9, 3.513511968150525*^9}, {3.51351214245735*^9, 
   3.513512145517376*^9}, {3.513513034772955*^9, 3.513513036106889*^9}, {
   3.513513980352088*^9, 3.513513993759684*^9}, {3.5135145516387253`*^9, 
   3.513514558386307*^9}, {3.5135146062619343`*^9, 3.513514629556363*^9}, {
   3.51351471546454*^9, 3.5135147196182833`*^9}, {3.513514757671224*^9, 
   3.513514759837731*^9}, {3.5135148175286493`*^9, 3.513514818324443*^9}, {
   3.513514850365286*^9, 3.513514887291841*^9}, {3.513514977812804*^9, 
   3.513514977934021*^9}, {3.513515157385755*^9, 3.51351518913976*^9}, {
   3.513516041183681*^9, 3.513516107492836*^9}, {3.5135161401937838`*^9, 
   3.5135161426970663`*^9}, {3.513516992957554*^9, 3.513516999427025*^9}, {
   3.513517319746479*^9, 3.513517354020041*^9}, {3.513517389577029*^9, 
   3.513517432176394*^9}, {3.51351755698096*^9, 3.513517577703835*^9}, {
   3.513517768624077*^9, 3.5135177822020597`*^9}, 3.513518064038707*^9, {
   3.513518096344686*^9, 3.513518128460349*^9}, {3.513518167340562*^9, 
   3.513518172024132*^9}, {3.5135183214862022`*^9, 3.513518338939986*^9}, {
   3.5135186645939207`*^9, 3.513518695238614*^9}, {3.5135188167725677`*^9, 
   3.513518828153287*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Parameters", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tol", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxPasses", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"passes", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefaultKernel", "=", "Dot"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numChangedAlphas", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]n", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"passes", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"While", "[", 
    RowBox[{
     RowBox[{"passes", "<", "maxPasses"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numChangedAlphas", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "n"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ActOnParameteri", "[", 
             RowBox[{"x", ",", "y", ",", "\[Alpha]n", ",", "i", ",", "b"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Alpha]n", ",", "b"}], "}"}], "=", 
             RowBox[{"iStep", "[", 
              RowBox[{"x", ",", "y", ",", "\[Alpha]n", ",", "i", ",", "b"}], 
              "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numChangedAlphas", "\[Equal]", "0"}], ",", 
         RowBox[{"passes", "++"}], ",", 
         RowBox[{"passes", "=", "0"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.513360372430995*^9, 3.513360372936985*^9}, {
   3.513360629666218*^9, 3.5133608184936543`*^9}, {3.513360871393469*^9, 
   3.5133608968143044`*^9}, {3.513365124062113*^9, 3.513365124228163*^9}, {
   3.5133672437270193`*^9, 3.513367244132305*^9}, {3.513367287978263*^9, 
   3.5133672885616903`*^9}, {3.513368329022963*^9, 3.513368336179761*^9}, {
   3.5133687287267103`*^9, 3.51336872885953*^9}, {3.513368932985265*^9, 
   3.513368972910858*^9}, 3.513369050110094*^9, {3.513369126871523*^9, 
   3.513369131674077*^9}, {3.513369857531007*^9, 3.513369858535593*^9}, {
   3.5133712328598433`*^9, 3.513371235773464*^9}, {3.5133736855202208`*^9, 
   3.51337368754524*^9}, {3.513374514214797*^9, 3.5133745194659567`*^9}, {
   3.513374560349923*^9, 3.513374586910041*^9}, {3.513375162198888*^9, 
   3.5133752130615053`*^9}, {3.513375251609679*^9, 3.51337525235183*^9}, {
   3.5133753800057373`*^9, 3.51337540806253*^9}, {3.513376179953081*^9, 
   3.513376193018098*^9}, {3.513376256144047*^9, 3.5133762585659943`*^9}, {
   3.51337634679852*^9, 3.5133763469813547`*^9}, {3.513511652803879*^9, 
   3.513511667925115*^9}, {3.513511982411702*^9, 3.5135119832725143`*^9}, 
   3.513512577839026*^9, {3.513514640609029*^9, 3.513514644087995*^9}, {
   3.513515192144395*^9, 3.513515192393201*^9}, 3.513516020079812*^9, {
   3.513516112632255*^9, 3.5135161299382467`*^9}, {3.513517786357601*^9, 
   3.513517798137103*^9}, {3.513518074309063*^9, 3.513518083059658*^9}, {
   3.513518141983808*^9, 3.513518154079361*^9}, 3.513518335266685*^9, {
   3.513518634042561*^9, 3.513518678864603*^9}, {3.513518832624002*^9, 
   3.513518836607563*^9}, {3.513519173825892*^9, 3.513519175113443*^9}, 
   3.5135192802110987`*^9, {3.513519314187771*^9, 3.5135193142541656`*^9}, {
   3.513519444964987*^9, 3.513519445187501*^9}, {3.5135209281320543`*^9, 
   3.513520929515106*^9}, 3.513521691858857*^9, 3.5135252073289833`*^9, {
   3.513526424881967*^9, 3.5135264251190157`*^9}, {3.51352726742251*^9, 
   3.513527272699538*^9}, 3.5139344380327578`*^9}],

Cell[TextData[{
 "The SMO algorithm returns the optimal dual variables ",
 Cell[BoxData[
  FormBox["\[Alpha]n", TraditionalForm]]],
 " and the offer ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]]],
 ". This completely defines the support vector classification function as \
given below."
}], "Text",
 CellChangeTimes->{{3.513516261107177*^9, 3.513516265873995*^9}, {
  3.5135163135343647`*^9, 3.513516344978314*^9}, {3.513516394501141*^9, 
  3.513516402134025*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Classify", "[", "x_", "]"}], ":=", 
  RowBox[{"Sign", "[", 
   RowBox[{"f", "[", 
    RowBox[{"x", ",", "\[Alpha]n", ",", "b"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.513516180025496*^9, 3.513516211489497*^9}, {
  3.513516349254314*^9, 3.5135163549349947`*^9}}],

Cell["\<\
For some random training data, we can see that 44 points are correctly \
classified while 6 are misclassified. \
\>", "Text",
 CellChangeTimes->{{3.51351640463869*^9, 3.513516442214275*^9}, {
  3.513934446852292*^9, 3.513934453131927*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{
   RowBox[{"Classify", "/@", "x"}], " ", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.513516213054997*^9, 3.513516215592844*^9}, {
  3.513516245761271*^9, 3.51351624843159*^9}, {3.513516366352799*^9, 
  3.51351637204951*^9}, {3.513516408256612*^9, 3.5135164093850107`*^9}, {
  3.5135182134102383`*^9, 3.513518214268476*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "44"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.513934442344974*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{640, 752},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 6, \
2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 189, 2, 26, "Subsubtitle"],
Cell[771, 26, 1749, 56, 202, "Input"],
Cell[CellGroupData[{
Cell[2545, 86, 71, 1, 27, "Input"],
Cell[2619, 89, 5987, 165, 268, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8643, 259, 69, 1, 27, "Input"],
Cell[8715, 262, 1085, 32, 58, "Output"]
}, Open  ]],
Cell[9815, 297, 18012, 432, 746, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[27830, 731, 4212, 85, 283, "Input"],
Cell[32045, 818, 469, 12, 41, "Text"],
Cell[32517, 832, 306, 7, 27, "Input"],
Cell[32826, 841, 249, 5, 26, "Text"],
Cell[CellGroupData[{
Cell[33100, 850, 374, 7, 27, "Input"],
Cell[33477, 859, 235, 8, 27, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
